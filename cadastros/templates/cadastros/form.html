{% extends base_template  %}

{% load static %}

{% load crispy_forms_tags %}



{% block conteudo %}

<div class="col-8 mx-auto">
    {% block titulo %}
        <h1>{{ titulo_form }}</h1>
    {% endblock %}

    <hr>
    <form action="" method="post" enctype="multipart/form-data">

        {% csrf_token %}

        {{ form|crispy }}

        <button type="submit" class="btn btn-primary w-100 mt-2">{{ titulo_botao }}</button>

    </form>

    {% if request.resolver_match.view_name == 'atualizar-perfil' %}
        <div class="d-flex justify-content-center mt-2">
            <a hre="#" class="link-danger mt-2" data-bs-toggle="modal" data-bs-target="#confirmModal{{ request.user.pk }}" title="Excluir" style="text-decoration: none; font-weight: bold;">Excluir Conta</a>

            <!-- Modal de confirmação -->
              <div class="modal fade" id="confirmModal{{ request.user.pk }}" tabindex="-1" aria-labelledby="confirmModalLabel{{ request.user.pk }}" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <form method="post" action="{% url 'excluir-perfil' request.user.pk %}">
                      {% csrf_token %}
                      <div class="modal-header">
                        <h5 class="modal-title" id="confirmModalLabel{{ request.user.pk }}">Confirmar exclusão</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                      </div>
                      <div class="modal-body">
                        Tem certeza que deseja excluir <strong>Sua Conta</strong>?
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-danger">Excluir</button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
        </div>


    {% endif %}


    {% if request.resolver_match.view_name == 'login' %}

        <p class="text-primary mt-4" style="text-align: center;">OU</p>


        <div class="d-flex justify-content-center">
            <a href="{% url 'registrar' %}" class="link-primary text-decoration-none" style="font-size: 1.2em;">Crie Sua Conta</a>
        </div>
    {% endif %}
    {% if request.resolver_match.view_name == 'registrar' %}

        <p class="text-primary mt-4" style="text-align: center;">OU</p>

        <div class="d-flex justify-content-center">
             <a href="{% url 'login' %}" class="link-primary text-decoration-none" style="font-size: 1.2em;">Entre Na Sua Conta</a>
        </div>
    {% endif %}
</div>




{% endblock %}

{% block scripts %}
    <script src="{% static 'js/jquery.mask.min.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/cleave.js@1.6.0/dist/cleave.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const precoInput = document.getElementById('id_preco');
            if (precoInput) {
                precoInput.setAttribute('type', 'text');
            }
        });
        $(document).ready(function(){
            $('#id_cpf').mask("000.000.000-00");
            $('#id_telefone').mask("(00) 00000-0000");
            $('#id_cep').mask("00000-000");
        });

        var cleave = new Cleave('#id_preco', {
            numeral: true,
            numeralThousandsGroupStyle: 'none',
            numeralDecimalMark: ',',
            delimiter: '',
            numeralDecimalScale: 2
        });
        $('form').on('submit', function() {
            let preco = $('#id_preco').val().replace(/\./g, '').replace(',', '.');
            $('#id_preco').val(preco);
        });
    </script>
    


{% endblock %}



